(this["webpackJsonpbook-market"]=this["webpackJsonpbook-market"]||[]).push([[0],{39:function(e,t,c){},65:function(e,t,c){"use strict";c.r(t);var s,n=c(1),a=c.n(n),r=c(13),o=c.n(r),i=(c(39),c(8)),l=c(74),d=c(5),b=c(0),u=function(e){var t=e.toggle,c=Object(d.c)((function(e){return e.cart}));return Object(b.jsxs)("nav",{className:"fixed-top navbar bg-white ps-4 pe-4 border",children:[Object(b.jsx)("span",{className:"textBlue h3 fw-bolder",to:"/",children:"Book Market"}),Object(b.jsx)("div",{className:"navbar-nav ms-auto",children:Object(b.jsxs)("a",{className:"nav-item nav-link active",to:"/cart",onClick:t,children:[Object(b.jsx)(l.a,{className:"textBlue"}),0!==c.cartList.length&&Object(b.jsx)("span",{className:"position-absolute top-2 start-2 translate-middle badge rounded-pill bg-danger",children:c.cartList.length})]})})]})},j=c(4),m=c(21),h=c.n(m),x=c(32),p=c(9),O=c(33),f=c.n(O),g=Object(p.b)("get/book",function(){var e=Object(x.a)(h.a.mark((function e(t,c){var s,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.rejectWith,c.getState,c.dipatch,e.prev=1,"https://book-set-task.herokuapp.com/api/list_books",e.next=5,f.a.get("https://book-set-task.herokuapp.com/api/list_books");case 5:return s=e.sent,n=s.data,e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,c){return e.apply(this,arguments)}}()),k=Object(p.c)({name:"books",initialState:{bookList:[],genreList:[],loading:!1},reducers:{resetStock:function(e,t){var c=t.payload;console.log("removed ",c.length,"book(s) from cart"),c.map((function(t){var c=e.bookList.findIndex((function(e){return e.book.id===t}));return-1!==c&&(e.bookList[c].count=e.bookList[c].book.stock),t}))},decreaseStock:function(e,t){var c=t.payload,s=e.bookList.findIndex((function(e){return e.book.id===c.book.id}));-1!==s&&e.bookList[s].count>0&&(e.bookList[s].count-=c.count)}},extraReducers:(s={},Object(j.a)(s,g.pending,(function(e){e.loading=!0})),Object(j.a)(s,g.fulfilled,(function(e,t){!function(e,t){e.bookList.length>0||t.payload.map((function(t){return e.bookList.push({book:t,count:t.stock}),t.genre.includes("|")?t.genre.split("|").map((function(t){return e.genreList.includes(t)||e.genreList.push(t),t})):e.genreList.includes(t.genre)||e.genreList.push(t.genre),t}))}(e,t),e.loading=!1})),Object(j.a)(s,g.rejected,(function(e){e.loading=!1})),s)}),v=k.actions,N=v.resetStock,y=v.decreaseStock,L=k.reducer,w=function(e){return(117.63*e.replace("$","").trim()).toFixed(0)},C=function(e){var t=e.split("/");return"".concat(t[2],"-").concat(t[1],"-").concat(t[0])},S=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},B=Object(p.c)({name:"cart",initialState:{cartList:[]},reducers:{addToCart:function(e,t){var c=t.payload,s=e.cartList.findIndex((function(e){return e.book.id===c.book.id}));s<0?e.cartList.length<5?e.cartList.push(c):alert("Cannot add more than 5 different books!"):e.cartList[s].count+=parseInt(c.count)},removeFromCart:function(e,t){var c=e.cartList.filter((function(e){return!t.payload.includes(e.book.id)}));e.cartList=c}}}),I=B.actions,R=I.addToCart,F=I.removeFromCart,Q=B.reducer,$=function(e){var t,c=e.book,s=e.count,a=Object(d.b)(),r=Object(n.useState)("1"),o=Object(i.a)(r,2),u=o[0],j=o[1];return Object(b.jsx)("div",{className:"col-sm-12 col-md-6 col-lg-3 m-auto p-2",children:Object(b.jsxs)("div",{className:"card shadow-sm ",children:[Object(b.jsx)("img",{src:c.image,alt:"",className:"card-img-top",style:{aspectRatio:"2/1"}}),Object(b.jsxs)("div",{className:"card-body",children:[Object(b.jsxs)("h5",{className:"card-title text-center",children:[c.name," (",(t=c.published_date,t.split("/")[0]),")"]}),Object(b.jsxs)("p",{className:"h6 text-success text-center mt-auto mb-auto",children:[" Rs.",S(w(c.price))]}),Object(b.jsxs)("div",{className:"card-text fw-light mt-2",children:["Author: ",c.author,Object(b.jsx)("br",{}),Object(b.jsxs)("div",{className:"d-flex",children:[Object(b.jsx)("span",{children:"Genre: "}),Object(b.jsxs)("span",{className:"text-truncate ms-2",children:[" ",c.genre," "]}),Object(b.jsx)("br",{})]}),"Stock: ",s,Object(b.jsx)("br",{}),Object(b.jsxs)("span",{className:"text-truncate",children:["Published on: ",C(c.published_date)," "]}),Object(b.jsx)("br",{})]}),Object(b.jsxs)("div",{className:"d-flex mt-2",children:[Object(b.jsx)("span",{className:"fw-light mt-auto mb-auto",children:"Qty: "}),Object(b.jsx)("div",{className:"ms-1",children:Object(b.jsx)("input",{type:"number",className:"form-control text-center align-middle",value:u,min:"1",max:s,onChange:function(e){return j(e.target.value.trim())}})}),Object(b.jsx)("button",{className:"btn btn-smbtn-primary ms-auto bgBlue text-light",onClick:function(){if(isNaN(parseInt(u)))alert("Quantity must be a Number!");else{var e=parseInt(u);if(e>s)alert("Selected Quantity is greater than stock quantity!");else{var t={book:c,count:e};a(R(t)),a(y(t)),j(1)}}},disabled:0===s,children:Object(b.jsx)(l.a,{})})]})]})]})})},_=function(e){var t=e.genreList,c=e.setFilter;return Object(b.jsx)("div",{className:"col-lg-4 col-md-6 col-xs-10 my-4",children:Object(b.jsxs)("select",{className:"form-select textBlue","aria-label":"Select Genre",onChange:function(e){return function(e){var t=e.target.value;c(t)}(e)},children:[Object(b.jsx)("option",{value:"",children:"Select Genre"}),t.map((function(e){return Object(b.jsx)("option",{value:e,children:e},e)}))]})})},E=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),c=t[0],s=t[1],a=Object(d.b)(),r=Object(d.c)((function(e){return e.books}));return Object(n.useEffect)((function(){0===r.bookList.length&&a(g())})),r.loading?Object(b.jsx)("div",{className:"container pt-4",children:r.loading&&Object(b.jsx)("div",{className:"progress",children:Object(b.jsx)("div",{className:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:{width:"100%"}})})}):Object(b.jsxs)("div",{className:"p-4 mx-4",children:[0!==r.genreList.length&&Object(b.jsx)(_,{genreList:r.genreList,setFilter:s}),""!==c&&Object(b.jsx)("div",{className:"row",children:r.bookList.filter((function(e){return e.book.genre.includes(c)})).map((function(e){return Object(b.jsx)($,{book:e.book,count:e.count},e.book.id)}))}),""===c&&Object(b.jsx)("div",{className:"row",children:r.bookList.map((function(e){return Object(b.jsx)($,{book:e.book,count:e.count},e.book.id)}))})]})},G=function(e){var t=e.book,c=e.count,s=Object(d.b)(),n=function(){s(F([t.id])),s(N([t.id]))},a=function(e){if(c+e!==0)if(c+e>t.stock)alert("Book out of stock!");else{var a={book:t,count:e};s(R(a)),s(y(a))}else n()};return Object(b.jsxs)("div",{style:{position:"relative"},children:[Object(b.jsx)("i",{className:"fas fs-2 fa-times-circle text-danger",style:{position:"absolute",right:"0px",top:"-8px"},onClick:n}),Object(b.jsxs)("div",{className:"row bg-white rounded-3 mx-2 my-4",children:[Object(b.jsx)("div",{className:"d-flex col-md-3 col-sm-4 ps-0",children:Object(b.jsx)("img",{src:t.image,className:"cartImg rounded-circle ms-2 my-auto"})}),Object(b.jsx)("div",{className:"col-md-6 col-sm-8",children:Object(b.jsxs)("ul",{className:"list-group list-group-flush px-2",children:[Object(b.jsx)("li",{className:"list-group-item h4",children:t.name}),Object(b.jsxs)("li",{className:"list-group-item",children:["Price: Rs.",S(w(t.price))]}),Object(b.jsxs)("li",{className:"list-group-item",children:[Object(b.jsx)("span",{children:"Quantity:"}),Object(b.jsxs)("div",{className:"d-flex mt-2",children:[Object(b.jsx)("button",{className:"btn btn-sm btn-outline-dark rounded-circle",style:{width:"2rem",height:"2rem"},onClick:function(){return a(-1)},children:"-"}),Object(b.jsx)("span",{className:"h4 mx-4",children:c}),Object(b.jsx)("button",{className:"btn btn-sm btn-outline-dark rounded-circle me-auto",style:{width:"2rem",height:"2rem"},disabled:c+1>t.stock,onClick:function(){return a(1)},children:"+"})]})]})]})}),Object(b.jsx)("div",{className:"col-md-3 col-sm-12 d-flex bg-light rounded",children:Object(b.jsxs)("p",{className:"m-auto p-2 text-center text-secondary align-middle",children:[Object(b.jsx)("u",{children:"Subtotal"}),Object(b.jsx)("br",{}),Object(b.jsxs)("span",{className:"h5 text-success",children:["Rs.",S(w(t.price)*c)]})]})})]})]})},T=function(e){var t=e.toggleCart,c=Object(d.b)(),s=Object(d.c)((function(e){return e.cart}));return 0===s.cartList.length?Object(b.jsx)("div",{className:"emptyCart",children:Object(b.jsx)("h3",{className:"text-secondary",children:"Cart Empty!"})}):Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:"row text-light text-center px-4",children:[Object(b.jsx)("i",{className:"fas fs-3 fw-light fa-chevron-right col-1 my-auto",onClick:t}),Object(b.jsx)("p",{className:"col-10 h4 p-2",children:"Cart"}),Object(b.jsx)("hr",{}),Object(b.jsxs)("span",{className:"fs-5 fw-bold m-auto col-sm-11 col-md-5",children:[Object(b.jsx)("span",{className:"fw-light",children:"Total amount:"})," Rs. ",S(function(e){var t=0;return e.map((function(e){var c=e.book.price.replace("$","");return t+=c*e.count,e})),w("$"+t)}(s.cartList))]}),Object(b.jsxs)("button",{onClick:function(){if(window.confirm("Do you want to checkout now?")){var e=[];s.cartList.map((function(t){return e.push(t.book.id),t})),c(F(e)),c(N(e))}},className:"btn btn-outline-light col-sm-11 col-md-5",children:["Clear Cart",Object(b.jsx)("i",{className:"fas fa-times-circle ms-2"})]}),Object(b.jsx)("hr",{className:"mt-3"})]}),Object(b.jsx)("div",{className:"container py-2",children:s.cartList.map((function(e){return Object(b.jsx)(G,{book:e.book,count:e.count},e.book.id)}))})]})};var W=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),c=t[0],s=t[1],a=function(){s(!c)};return Object(b.jsxs)("div",{className:"app",children:[c&&Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:"blackOverlay",onClick:a}),Object(b.jsx)("div",{className:"cartOverlay",children:Object(b.jsx)(T,{toggleCart:a})})]}),Object(b.jsx)(u,{toggle:a}),Object(b.jsx)("div",{className:"mt-4 overflow-hidden",children:Object(b.jsx)("div",{className:"col-12",children:Object(b.jsx)(E,{})})})]})},J=Object(p.a)({reducer:{books:L,cart:Q}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(d.a,{store:J,children:Object(b.jsx)(W,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[65,1,2]]]);
//# sourceMappingURL=main.e5305d03.chunk.js.map